---
title: "Data"
author: "Daniel & Ellie"
date: "2025-03-23"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Import Data and Packages
```{r Data and Packages}
library(lubridate)
library(ggplot2)
library(forecast)
library(Kendall)
library(tseries)
library(outliers)
library(tidyverse)
library(smooth)
library(zoo)
library(kableExtra)
library(readxl)
library(dplyr)

# Assuming data folder in same location as the active folder
load_data <- read_excel(path="../tsa-spring-2025/load.xlsx", col_names=TRUE)
# Full path without ~
load_data <- read_excel(path = path.expand("~/Downloads/load.xlsx"), col_names = TRUE)

# Now, load_data is the data from the correct file path

load_data <- mutate(load_data, date = ymd(date))
relative_humidity_data <- read_excel(path="../tsa-spring-2025/relative_humidity.xlsx", col_names=TRUE)
relative_humidity_data <- read_excel(path = path.expand("~/Downloads/relative_humidity.xlsx"), col_names = TRUE)

temperature_data <- read_excel(path="../tsa-spring-2025/temperature.xlsx", col_names=TRUE)
temperature_data <- read_excel(path = path.expand("~/Downloads/temperature.xlsx"), col_names = TRUE)


# do we need this read in?
sub_template <- read_excel(path="../tsa-spring-2025/submission_template.xlsx", col_names=TRUE)
sub_template <- read_excel(path = path.expand("~/Downloads/submission_template.xlsx"), col_names = TRUE)

# Convert hourly data into daily training data (2005-2009)
daily_load_data <- load_data %>% 
  filter(date < as.Date("2009-01-01")) %>%
  select(h1:h24) %>%
  rowSums(na.rm = FALSE) %>%
  msts(seasonal.periods =c(7,365.25), start = c(2005, 1, 1))

autoplot(daily_load_data)

# Adding more TBD


```
